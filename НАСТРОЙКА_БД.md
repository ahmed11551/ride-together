# ðŸ—„ï¸ ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ

## ðŸ“‹ Ð‘Ñ‹ÑÑ‚Ñ€Ð°Ñ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ:

### ÐÐ° ÑÐµÑ€Ð²ÐµÑ€Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ:

```bash
cd /var/www/ride-together/server

# Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚ SETUP_DB_ON_SERVER.sh (ÑÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ Ð¸Ð· Ñ„Ð°Ð¹Ð»Ð° SETUP_DB_ON_SERVER.sh)

# Ð˜Ð»Ð¸ ÑÐ¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ñ‡ÐµÑ€ÐµÐ· cat:
cat > SETUP_DB_ON_SERVER.sh << 'SCRIPT_END'
[Ð²ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ SETUP_DB_ON_SERVER.sh]
SCRIPT_END

chmod +x SETUP_DB_ON_SERVER.sh
./SETUP_DB_ON_SERVER.sh
```

---

## ðŸ”§ Ð§Ñ‚Ð¾ Ð´ÐµÐ»Ð°ÐµÑ‚ ÑÐºÑ€Ð¸Ð¿Ñ‚:

1. âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚/ÑƒÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ PostgreSQL
2. âœ… Ð¡Ð¾Ð·Ð´Ð°ÐµÑ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ `ride_user` Ñ ÑÐ»ÑƒÑ‡Ð°Ð¹Ð½Ñ‹Ð¼ Ð¿Ð°Ñ€Ð¾Ð»ÐµÐ¼
3. âœ… Ð¡Ð¾Ð·Ð´Ð°ÐµÑ‚ Ð±Ð°Ð·Ñƒ Ð´Ð°Ð½Ð½Ñ‹Ñ… `ride_together`
4. âœ… Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ñ (uuid-ossp, pgcrypto)
5. âœ… ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÑ‚ `ecosystem.config.cjs` Ñ Ð½Ð¾Ð²Ñ‹Ð¼ DATABASE_URL
6. âœ… ÐŸÑ€Ð¸Ð¼ÐµÐ½ÑÐµÑ‚ ÑÑ…ÐµÐ¼Ñƒ Ð¸Ð· `TIMEWEB_FULL_SCHEMA.sql`
7. âœ… ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ PM2 Ñ Ð½Ð¾Ð²Ñ‹Ð¼Ð¸ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¼Ð¸

---

## ðŸ“ Ð ÑƒÑ‡Ð½Ð°Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° (ÐµÑÐ»Ð¸ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð½Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚):

```bash
# 1. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ PostgreSQL
sudo apt update
sudo apt install postgresql postgresql-contrib -y
sudo systemctl start postgresql
sudo systemctl enable postgresql

# 2. Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¸ Ð±Ð°Ð·Ñƒ
sudo -u postgres psql << EOF
CREATE USER ride_user WITH PASSWORD 'Ð²Ð°Ñˆ_Ð½Ð°Ð´ÐµÐ¶Ð½Ñ‹Ð¹_Ð¿Ð°Ñ€Ð¾Ð»ÑŒ';
CREATE DATABASE ride_together OWNER ride_user;
GRANT ALL PRIVILEGES ON DATABASE ride_together TO ride_user;
\c ride_together
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
CREATE EXTENSION IF NOT EXISTS "pgcrypto";
\q
EOF

# 3. ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ ecosystem.config.cjs
nano ecosystem.config.cjs
# Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ DATABASE_URL Ð½Ð°:
# DATABASE_URL: 'postgresql://ride_user:Ð¿Ð°Ñ€Ð¾Ð»ÑŒ@localhost:5432/ride_together'

# 4. ÐŸÑ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ ÑÑ…ÐµÐ¼Ñƒ
psql postgresql://ride_user:Ð¿Ð°Ñ€Ð¾Ð»ÑŒ@localhost:5432/ride_together < ../TIMEWEB_FULL_SCHEMA.sql

# 5. ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ PM2
pm2 restart ride-backend --update-env
pm2 logs ride-backend
```

---

## âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ°:

```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ
psql postgresql://ride_user:Ð¿Ð°Ñ€Ð¾Ð»ÑŒ@localhost:5432/ride_together -c "SELECT version();"

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹
psql postgresql://ride_user:Ð¿Ð°Ñ€Ð¾Ð»ÑŒ@localhost:5432/ride_together -c "\dt"

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð»Ð¾Ð³Ð¸ PM2
pm2 logs ride-backend --lines 50
```

---

## ðŸ”’ Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ:

âš ï¸ **Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚Ðµ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð² Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾Ð¼ Ð¼ÐµÑÑ‚Ðµ!**

ÐŸÐ°Ñ€Ð¾Ð»ÑŒ Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ð¾ÐºÐ°Ð·Ð°Ð½ Ð² ÐºÐ¾Ð½ÑÐ¾Ð»Ð¸ Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½ Ð² `ecosystem.config.cjs`.

