# Тестирование полного цикла работы приложения

## Чеклист для проверки функциональности

### 1. Регистрация и вход

#### Регистрация
- [ ] Перейти на `/auth`
- [ ] Переключиться на вкладку "Регистрация"
- [ ] Заполнить форму:
  - Email: `test@example.com`
  - Пароль: `test123456`
  - Имя: `Тестовый Пользователь`
- [ ] Нажать "Зарегистрироваться"
- [ ] Проверить, что появилось сообщение об успешной регистрации
- [ ] Проверить, что пользователь автоматически вошел в систему

#### Вход
- [ ] Выйти из системы (если залогинен)
- [ ] Перейти на `/auth`
- [ ] Ввести email и пароль
- [ ] Нажать "Войти"
- [ ] Проверить, что вход выполнен успешно
- [ ] Проверить, что перенаправление на главную страницу работает

#### Восстановление пароля
- [ ] На странице входа нажать "Забыли пароль?"
- [ ] Ввести email
- [ ] Нажать "Отправить инструкции"
- [ ] Проверить, что появилось сообщение об отправке письма
- [ ] Проверить email (если настроен)

### 2. Создание поездки

#### Создание поездки (требует авторизации)
- [ ] Войти в систему
- [ ] Перейти на `/create-ride`
- [ ] Заполнить форму:
  - Откуда: выбрать на карте или ввести адрес
  - Куда: выбрать на карте или ввести адрес
  - Дата: выбрать дату
  - Время: выбрать время
  - Цена: `1500`
  - Места: `4`
  - Правила: выбрать опции
- [ ] Нажать "Создать поездку"
- [ ] Проверить, что поездка создана
- [ ] Проверить, что появилось сообщение об успехе
- [ ] Проверить, что поездка отображается в "Мои поездки"

### 3. Поиск и бронирование

#### Поиск поездок
- [ ] Перейти на `/search` или использовать форму поиска на главной
- [ ] Ввести параметры:
  - Откуда: `Москва`
  - Куда: `Санкт-Петербург`
  - Дата: выбрать дату
  - Пассажиры: `1`
- [ ] Нажать "Найти"
- [ ] Проверить, что отображаются результаты поиска
- [ ] Проверить, что поездки отображаются на карте
- [ ] Проверить, что маршруты видны на карте

#### Бронирование
- [ ] Выбрать поездку из результатов поиска
- [ ] Перейти на страницу деталей поездки `/ride/:id`
- [ ] Проверить, что отображается:
  - Информация о поездке
  - Карта с маршрутом
  - Информация о водителе с рейтингом (звёздочки)
  - Кнопка "Забронировать"
- [ ] Выбрать количество мест
- [ ] Нажать "Забронировать"
- [ ] Проверить, что бронирование создано
- [ ] Проверить, что появилось сообщение об успехе
- [ ] Проверить, что бронирование отображается в "Мои бронирования"

### 4. Подтверждение бронирования (для водителя)

#### Подтверждение
- [ ] Войти как водитель (создатель поездки)
- [ ] Перейти на `/my-rides`
- [ ] Найти поездку с новым бронированием
- [ ] Нажать "Управление бронированиями"
- [ ] Проверить, что отображается список бронирований
- [ ] Нажать "Подтвердить" для бронирования
- [ ] Проверить, что статус изменился на "Подтверждено"
- [ ] Проверить, что количество свободных мест уменьшилось

### 5. Чат (реальный, не демо)

#### Доступ к чату
- [ ] Перейти на страницу поездки `/ride/:id`
- [ ] Проверить, что отображается компонент `RideChat` (не `DemoChat`)
- [ ] Проверить, что чат доступен только участникам поездки:
  - Водителю
  - Пассажирам с подтвержденным бронированием

#### Отправка сообщений
- [ ] Войти как участник поездки
- [ ] Открыть чат на странице поездки
- [ ] Ввести сообщение
- [ ] Нажать "Отправить" или Enter
- [ ] Проверить, что сообщение появилось в чате
- [ ] Проверить, что сообщение отображается в реальном времени (Supabase Realtime)
- [ ] Проверить, что отображается имя отправителя и аватар

#### Получение сообщений
- [ ] Открыть чат в двух разных браузерах/вкладках
- [ ] Отправить сообщение из одного браузера
- [ ] Проверить, что сообщение появилось во втором браузере в реальном времени

### 6. Рейтинги и отзывы

#### Просмотр рейтингов
- [ ] Проверить, что в списке поездок отображаются звёздочки у водителей
- [ ] Проверить, что рейтинг отображается в `RideCard`
- [ ] Проверить, что рейтинг отображается на странице деталей поездки
- [ ] Проверить, что рейтинг отображается в профиле пользователя

#### Создание отзыва
- [ ] Завершить поездку (изменить статус на "completed")
- [ ] Перейти на `/my-bookings`
- [ ] Найти завершенную поездку
- [ ] Проверить, что появился запрос на отзыв
- [ ] Нажать "Оставить отзыв"
- [ ] Выбрать рейтинг (1-5 звёзд)
- [ ] Написать комментарий
- [ ] Нажать "Отправить"
- [ ] Проверить, что отзыв сохранен
- [ ] Проверить, что рейтинг водителя обновился

### 7. Админ панель

#### Доступ к админке
- [ ] Войти как администратор (пользователь с `is_admin = true`)
- [ ] Перейти на `/admin`
- [ ] Проверить, что админка доступна
- [ ] Проверить, что не-админы не могут получить доступ

#### Управление жалобами
- [ ] Проверить, что отображаются все жалобы
- [ ] Проверить, что жалобы разделены на "Ожидают рассмотрения" и "Остальные"
- [ ] Выбрать жалобу
- [ ] Изменить статус (например, на "Рассмотрено")
- [ ] Добавить заметки модератора
- [ ] Нажать "Сохранить"
- [ ] Проверить, что статус обновился

#### Управление пользователями
- [ ] Перейти на вкладку "Пользователи" в админке
- [ ] Проверить, что отображается список всех пользователей
- [ ] Использовать поиск для поиска пользователя
- [ ] Проверить, что отображается информация:
  - Имя
  - Телефон
  - Рейтинг (звёздочки)
  - Количество поездок
  - Статусы (админ, проверен, заблокирован)
- [ ] Нажать "Заблокировать" для пользователя
- [ ] Проверить, что пользователь заблокирован
- [ ] Нажать "Разблокировать"
- [ ] Проверить, что пользователь разблокирован

### 8. Профиль

#### Редактирование профиля
- [ ] Перейти на `/profile`
- [ ] Нажать "Редактировать"
- [ ] Изменить имя
- [ ] Изменить телефон
- [ ] Загрузить аватар (если доступно)
- [ ] Нажать "Сохранить"
- [ ] Проверить, что данные сохранились
- [ ] Обновить страницу
- [ ] Проверить, что данные остались сохраненными

### 9. Проверка карт и маршрутов

#### Визуализация маршрутов
- [ ] Перейти на главную страницу
- [ ] Переключиться на вкладку "Карта"
- [ ] Проверить, что поездки отображаются на карте
- [ ] Проверить, что маршруты видны между точками отправления и назначения
- [ ] Проверить, что маркеры A (отправление) и B (назначение) отображаются
- [ ] Кликнуть на маркер
- [ ] Проверить, что открывается страница деталей поездки

#### Маршрут на странице поездки
- [ ] Перейти на страницу деталей поездки `/ride/:id`
- [ ] Проверить, что отображается карта с маршрутом
- [ ] Проверить, что отображается расстояние и время в пути
- [ ] Проверить, что маршрут визуализирован линией между точками

---

## Известные проблемы и ограничения

### Чат
- ✅ Реальный чат реализован в `RideChat.tsx`
- ✅ Использует Supabase Realtime для обновлений в реальном времени
- ✅ Доступ только для участников поездки
- ⚠️ Демо-чат на главной странице (`DemoChat`) - это только демонстрация

### Рейтинги
- ✅ Рейтинги отображаются в `RideCard` (звёздочки)
- ✅ Рейтинги отображаются на странице деталей поездки
- ✅ Рейтинги отображаются в профиле

### Карты
- ✅ Визуализация маршрутов добавлена
- ✅ Маршруты отображаются на карте с поездками
- ✅ Маршрут отображается на странице деталей поездки
- ⚠️ Требуется Yandex Maps API ключ для полной функциональности

### Админка
- ✅ Управление жалобами работает
- ✅ Управление пользователями добавлено
- ✅ Поиск пользователей работает
- ✅ Блокировка/разблокировка пользователей работает

---

## Рекомендации по тестированию

1. **Создайте тестовые аккаунты:**
   - Водитель: `driver@test.com`
   - Пассажир: `passenger@test.com`
   - Админ: `admin@test.com` (установите `is_admin = true` в БД)

2. **Проверьте все сценарии:**
   - Создание поездки → Поиск → Бронирование → Подтверждение → Чат → Отзыв

3. **Проверьте на разных устройствах:**
   - Desktop
   - Mobile
   - Tablet

4. **Проверьте граничные случаи:**
   - Пустая база данных
   - Большое количество поездок
   - Одновременные бронирования
   - Отмена бронирования

