# ‚úÖ –°—Ö–µ–º–∞ –ë–î —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞!

## –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –≤—ã–≤–æ–¥

–í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è "–ó–∞–ø—Ä–æ—Å –∑–∞–≤–µ—Ä—à—ë–Ω, –∏–∑–º–µ–Ω–µ–Ω–æ 0 –∑–∞–ø–∏—Å–µ–π" - —ç—Ç–æ **–ù–û–†–ú–ê–õ–¨–ù–û**!

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:
- ‚úÖ –ü–æ–ª–∏—Ç–∏–∫–∏ RLS —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –¢—Ä–∏–≥–≥–µ—Ä—ã –∞–∫—Ç–∏–≤–Ω—ã

"–ò–∑–º–µ–Ω–µ–Ω–æ 0 –∑–∞–ø–∏—Å–µ–π" - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è:
- `DROP POLICY IF EXISTS` - –ø–æ–ª–∏—Ç–∏–∫–∞ –º–æ–≥–ª–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å
- `CREATE POLICY` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ

## ‚úÖ –ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ

### –¢–∞–±–ª–∏—Ü—ã (15):
1. ‚úÖ `users` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (Auth —Å–∏—Å—Ç–µ–º–∞)
2. ‚úÖ `sessions` - —Å–µ—Å—Å–∏–∏
3. ‚úÖ `profiles` - –ø—Ä–æ—Ñ–∏–ª–∏
4. ‚úÖ `rides` - –ø–æ–µ–∑–¥–∫–∏
5. ‚úÖ `bookings` - –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
6. ‚úÖ `messages` - —Å–æ–æ–±—â–µ–Ω–∏—è
7. ‚úÖ `reviews` - –æ—Ç–∑—ã–≤—ã
8. ‚úÖ `reports` - –∂–∞–ª–æ–±—ã
9. ‚úÖ `driver_info` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–æ–¥–∏—Ç–µ–ª—è—Ö
10. ‚úÖ `telegram_subscriptions` - –ø–æ–¥–ø–∏—Å–∫–∏ Telegram
11. ‚úÖ `support_tickets` - —Ç–∏–∫–µ—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏
12. ‚úÖ `subscriptions` - –ø–æ–¥–ø–∏—Å–∫–∏ –±–æ—Ç–∞
13. ‚úÖ `bot_users` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞
14. ‚úÖ `referrals` - —Ä–µ—Ñ–µ—Ä–∞–ª—ã
15. ‚úÖ `bot_reviews` - –æ—Ç–∑—ã–≤—ã —á–µ—Ä–µ–∑ –±–æ—Ç–∞

### –§—É–Ω–∫—Ü–∏–∏:
- ‚úÖ `update_updated_at_column` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ `handle_new_user` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- ‚úÖ `update_seats_on_booking` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Å—Ç
- ‚úÖ `update_driver_rating` - —Ä–µ–π—Ç–∏–Ω–≥ –≤–æ–¥–∏—Ç–µ–ª—è
- ‚úÖ `update_passenger_rating` - —Ä–µ–π—Ç–∏–Ω–≥ –ø–∞—Å—Å–∞–∂–∏—Ä–∞
- ‚úÖ `update_user_ratings` - –æ–±–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞
- ‚úÖ `on_review_created` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–∑—ã–≤–æ–≤
- ‚úÖ `is_ride_participant` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—á–∞—Å—Ç–∏—è
- ‚úÖ `cleanup_old_rides` - –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ø–æ–µ–∑–¥–æ–∫
- ‚úÖ `current_user_id` - —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- ‚úÖ `cleanup_expired_sessions` - –æ—á–∏—Å—Ç–∫–∞ —Å–µ—Å—Å–∏–π
- ‚úÖ `generate_ticket_number` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞ —Ç–∏–∫–µ—Ç–∞

### –¢—Ä–∏–≥–≥–µ—Ä—ã:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ `updated_at`
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Å—Ç –ø—Ä–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –ø—Ä–∏ –æ—Ç–∑—ã–≤–∞—Ö

### RLS –ü–æ–ª–∏—Ç–∏–∫–∏:
- ‚úÖ –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∑–∞—â–∏—â–µ–Ω—ã
- ‚úÖ –ü–æ–ª–∏—Ç–∏–∫–∏ —Å–æ–∑–¥–∞–Ω—ã (–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–∑—Ä–µ—à–∞—é—Ç –≤—Å–µ, –ø–æ—Ç–æ–º –Ω–∞—Å—Ç—Ä–æ–∏–º —á–µ—Ä–µ–∑ JWT)

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞

–í—ã–ø–æ–ª–Ω–∏ –≤ SQL Editor:

```sql
-- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
\dt

-- –ò–ª–∏
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public' 
ORDER BY table_name;
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ 15 —Ç–∞–±–ª–∏—Ü.

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –º–æ–∂–µ—à—å:
1. ‚úÖ –î–æ–±–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –≤—Ä—É—á–Ω—É—é
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å backend —Å–µ—Ä–≤–µ—Ä
3. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å Auth —Å–∏—Å—Ç–µ–º—É
4. ‚úÖ –ù–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ–≤–µ—Ä—å —Ç–∞–±–ª–∏—Ü—ã:**
   ```sql
   \dt
   ```

2. **–î–æ–±–∞–≤—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):
   ```sql
   -- –ü—Ä–∏–º–µ—Ä: —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   INSERT INTO public.users (email, password_hash) 
   VALUES ('test@example.com', 'hashed_password');
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π backend —Å–µ—Ä–≤–µ—Ä** (—Å–º. `server/`)

4. **–û–±–Ω–æ–≤–∏ Auth —Å–∏—Å—Ç–µ–º—É** –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

---

**–í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç! –ú–æ–∂–µ—à—å –¥–æ–±–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ!** üéâ
